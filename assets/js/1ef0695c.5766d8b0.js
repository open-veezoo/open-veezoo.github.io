"use strict";(self.webpackChunkveezoo_docs=self.webpackChunkveezoo_docs||[]).push([[2037],{3905:function(e,t,o){o.d(t,{Zo:function(){return p},kt:function(){return m}});var n=o(7294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var d=n.createContext({}),l=function(e){var t=n.useContext(d),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},p=function(e){var t=l(e.components);return n.createElement(d.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,d=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(o),h=a,m=u["".concat(d,".").concat(h)]||u[h]||c[h]||r;return o?n.createElement(m,i(i({ref:t},p),{},{components:o})):n.createElement(m,i({ref:t},p))}));function m(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,i=new Array(r);i[0]=h;var s={};for(var d in t)hasOwnProperty.call(t,d)&&(s[d]=t[d]);s.originalType=e,s[u]="string"==typeof e?e:a,i[1]=s;for(var l=2;l<r;l++)i[l]=o[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}h.displayName="MDXCreateElement"},1007:function(e,t,o){o.r(t),o.d(t,{assets:function(){return p},contentTitle:function(){return d},default:function(){return m},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return u}});var n=o(7462),a=o(3366),r=(o(7294),o(3905)),i=["components"],s={},d="How to embed Veezoo: a Demonstration",l={unversionedId:"embedded-step-by-step-guide/hyperstore-guide",id:"embedded-step-by-step-guide/hyperstore-guide",title:"How to embed Veezoo: a Demonstration",description:"Hello dear user!",source:"@site/docs/embedded-step-by-step-guide/hyperstore-guide.md",sourceDirName:"embedded-step-by-step-guide",slug:"/embedded-step-by-step-guide/hyperstore-guide",permalink:"/docs/embedded-step-by-step-guide/hyperstore-guide",draft:!1,editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/embedded-step-by-step-guide/hyperstore-guide.md",tags:[],version:"current",frontMatter:{}},p={},u=[{value:"0. Requirements",id:"0-requirements",level:3},{value:"0.5. Our Demo: the Hyperstore",id:"05-our-demo-the-hyperstore",level:3},{value:"1. Getting started",id:"1-getting-started",level:3},{value:"2. Initial Veezoo Configurations",id:"2-initial-veezoo-configurations",level:3},{value:"3. Create Tenants",id:"3-create-tenants",level:3},{value:"4. Setting up the Local Website",id:"4-setting-up-the-local-website",level:3},{value:"5. Limiting access and Virtual Tables",id:"5-limiting-access-and-virtual-tables",level:3},{value:"Conclusion",id:"conclusion",level:3}],c={toc:u},h="wrapper";function m(e){var t=e.components,o=(0,a.Z)(e,i);return(0,r.kt)(h,(0,n.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-to-embed-veezoo-a-demonstration"},"How to embed Veezoo: a Demonstration"),(0,r.kt)("p",null,"Hello dear user!"),(0,r.kt)("p",null,"This is a step-by-step guide on how to set up a locally hosted demo website, which has Veezoo embedded. It is meant to give users a first impression on how you could integrate the power of Veezoo into your product. This guide can be viewed as a sort of companion to the embedded Veezoo docs (",(0,r.kt)("a",{parentName:"p",href:"https://docs.veezoo.com/docs/embedded/embedded-guide/"},"https://docs.veezoo.com/docs/embedded/embedded-guide/"),"). Those docs are much more general and explain all different options available, as well as all the details already implemented in this demo. This guide repeats some of the points mentioned there, so that this is all you need to set it up. The goal here is not to demonstrate all the details, but to get a clean, working version (with all basic features) up and running as easily as possible. Have fun!"),(0,r.kt)("h3",{id:"0-requirements"},"0. Requirements"),(0,r.kt)("p",null,"This project includes all the code you need to host the demo website on your local machine, as well as a demo dataset you can use. Alternatively you can integrate your own dataset just as well, though this tutorial will assume you use the dataset provided (This will mainly matter in step 5., where it will be mentioned again). To run this project, you need a Veezoo account that has embedding enabled (this feature is per default not enabled) and enough available ",(0,r.kt)("em",{parentName:"p"},"knowledge graphs")," (at least 2) and ",(0,r.kt)("em",{parentName:"p"},"users"),", as well as access to a data warehouse like PostgreSQL or Big Query (Veezoo embedding is not compatible with spreadsheets directly uploaded to Veezoo)."),(0,r.kt)("h3",{id:"05-our-demo-the-hyperstore"},"0.5. Our Demo: the Hyperstore"),(0,r.kt)("p",null,"A short note on the demo we are building: the Hyperstore. The Hyperstore is a fictional online marketplace, where different vendors can sell their products. A lot of products are ordered and shipped to customers all over the US. All these transactions create a lot of data of course, which are saved in three tables: ",(0,r.kt)("em",{parentName:"p"},"Customer"),", ",(0,r.kt)("em",{parentName:"p"},"Order")," and ",(0,r.kt)("em",{parentName:"p"},"Product"),". We are now implementing a back end for our vendors (currently three), which would like to get insights from their data. Now, we as managers of Hyperstore want to give our vendors as much insight as possible, though only about their own transactions. That's why we naturally came to the conclusion, we have to implement Veezoo :-)"),(0,r.kt)("h3",{id:"1-getting-started"},"1. Getting started"),(0,r.kt)("p",null,"To get started, upload the ",(0,r.kt)("em",{parentName:"p"},"hyperstore")," spreadsheet contained in this repo to your data warehouse (in case you don't want to use your own dataset). If you don't already have one, create a Veezoo account and make sure it includes at least 2 ",(0,r.kt)("em",{parentName:"p"},"knowledge graphs"),". Either use a free trial for a higher tier account, or contact Veezoo to enable a second ",(0,r.kt)("em",{parentName:"p"},"knowledge graphs")," in your free account. Connect it to your data warehouse, as you would for regular Veezoo usage. You can follow this guide: ",(0,r.kt)("a",{parentName:"p",href:"https://docs.veezoo.com/docs/"},"https://docs.veezoo.com/docs/")," (as mentioned before, connecting to an Excel spreadsheet will not work). Select the data you want to work with and configure it to your desires and ask a couple of questions to ensure that everything is working properly."),(0,r.kt)("p",null,"Once everything looks fine, contact Veezoo to enable embedding. This can only be done manually by Veezoo. "),(0,r.kt)("h3",{id:"2-initial-veezoo-configurations"},"2. Initial Veezoo Configurations"),(0,r.kt)("p",null,"Once you have been granted access to the embedded option, open ",(0,r.kt)("em",{parentName:"p"},"Veezoo Admin")," and navigate to ",(0,r.kt)("em",{parentName:"p"},"Embedded")," >> ",(0,r.kt)("em",{parentName:"p"},"Configuration")," and make sure the Toggle Switch is ",(0,r.kt)("strong",{parentName:"p"},"ON")," (Embedding is enabled). For secure embedding, you need to specify the allowed hosts. This ensures that your Veezoo content is only accessible from your designated, trusted domains. In our case this means add ",(0,r.kt)("a",{parentName:"p",href:"http://127.0.0.1:5000/"},"http://127.0.0.1:5000/")," (local host) as an allowed origin. "),(0,r.kt)("p",null,"Veezoo uses JWT for user authentication within Embedded Analytics. To enable secure access to relevant data and analytics, your application will have to generate a JWT on your server and pass it to Veezoo. For that to work, we need to configure in ",(0,r.kt)("em",{parentName:"p"},"Veezoo Admin")," the public key for a private key that will be used by your application to sign the token."),(0,r.kt)("p",null,"If you don't know how to create a key pair, follow the instructions provided. Add the public key as text in the corresponding field."),(0,r.kt)("h3",{id:"3-create-tenants"},"3. Create Tenants"),(0,r.kt)("p",null,"To access Veezoo via embedding, you have to specify the tenant you are. Tenants can later be used to restrict access of users to certain parts of your data (in our example, we want vendors only to be able to access data about their own transactions). As a start, we will create 4 of them."),(0,r.kt)("p",null,"In ",(0,r.kt)("em",{parentName:"p"},"Veezoo Admin"),", navigate to ",(0,r.kt)("em",{parentName:"p"},"Embedded")," >> ",(0,r.kt)("em",{parentName:"p"},"Tenants"),". Click on ",(0,r.kt)("em",{parentName:"p"},"CREATE"),'. Set the ID to 0, give the tenant the name "Admin" and click on ',(0,r.kt)("em",{parentName:"p"},"CREATE"),'. Create 3 additional tenants called "Furniture Shop", "Office Supplies Shop" and "Technology Shop" with IDs 1, 2 and 3 respectively. These represent an Admin of Hyperstore (who will see everything) and the three vendors.'),(0,r.kt)("p",null,"We now have to grant these tenants access to a specific ",(0,r.kt)("em",{parentName:"p"},"knowledge graph"),". Open ",(0,r.kt)("em",{parentName:"p"},"Veezoo Studio")," and select the ",(0,r.kt)("em",{parentName:"p"},"hyperstore knowledge graph")," you created earlier and click on ",(0,r.kt)("em",{parentName:"p"},"Tenant Access"),". Click on ",(0,r.kt)("em",{parentName:"p"},"CREATE")," to add all your newly created tenants. Veezoo is now ready for embedding."),(0,r.kt)("h3",{id:"4-setting-up-the-local-website"},"4. Setting up the Local Website"),(0,r.kt)("p",null,"Download the project in this repo. The website is created using Python Flask. First, install the libraries ",(0,r.kt)("inlineCode",{parentName:"p"},"cryptography"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"pyjwt"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"uuid")," with pip. To locally run the website, there are a couple of things you have to change in the code. "),(0,r.kt)("p",null,"Open the ",(0,r.kt)("inlineCode",{parentName:"p"},"app.py"),' file. Insert your private key where it says "',(0,r.kt)("em",{parentName:"p"},"INSERT PRIVATE KEY HERE"),'". This is the one you previously created and corresponds to the public key you added to Veezoo. Now take a look at the functions ',(0,r.kt)("inlineCode",{parentName:"p"},"Admin()"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Flavia()"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Oliver()")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Tom()"),". Here we have to adjust the URLs. In the second to last line of each function it currently says:\n",(0,r.kt)("inlineCode",{parentName:"p"},'veezoo_url = f"https://embedded-demo.app.veezoo.com?jwt={jwt}&embedded=true"'),"\nTake a look at Veezoo in your browsers and check what the domain is. It should be something like ",(0,r.kt)("inlineCode",{parentName:"p"},"<yourname>.app.veezoo.com/..."),". Back in the python code, change ",(0,r.kt)("inlineCode",{parentName:"p"},"embedded-demo")," in each function to whatever ",(0,r.kt)("inlineCode",{parentName:"p"},"<yourname>")," is. "),(0,r.kt)("p",null,"Now open the four HTML files ",(0,r.kt)("inlineCode",{parentName:"p"},"Admin.html"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Flavia.html"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Oliver.html")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Tom.html"),". In each file, there are two places in the code where it says ",(0,r.kt)("inlineCode",{parentName:"p"},"https://embedded-demo.app.veezoo.com"),". Change every instance to ",(0,r.kt)("inlineCode",{parentName:"p"},"https://<yourname>.app.veezoo.com"),"."),(0,r.kt)("p",null,"You are now ready to run the code. When you do so, you can open a browser and go to ",(0,r.kt)("a",{parentName:"p",href:"http://127.0.0.1:5000/"},"http://127.0.0.1:5000/"),' to see your newly created website. If you are using Chrome (which I recommend), I would suggest you open a guest-tab (click on your profile in the top right corner, click on "guest"), otherwise you have to clear your cookies every time you open ',(0,r.kt)("em",{parentName:"p"},"Veezoo Studio")," again. On the page, you should see on the top right a ",(0,r.kt)("em",{parentName:"p"},"Sign in!")," button. Click on it and choose a user. You can now enjoy the full embedded Veezoo experience."),(0,r.kt)("p",null,"As this is a demo site, most buttons are for decoration, but if you click on ",(0,r.kt)("em",{parentName:"p"},"Dashboards")," you will see an overview of this user's dashboards. You can display them by clicking on them. As in regular Veezoo, you can create new dashboards in the chat, which then will also show up here. These boards are visible only be visible to the user who created them (just like regular Veezoo)."),(0,r.kt)("h3",{id:"5-limiting-access-and-virtual-tables"},"5. Limiting access and Virtual Tables"),(0,r.kt)("p",null,"So far we have four users on our website. They all can create their own boards, but we want to go a bit further. The main advantage of having different tenants (and not just different users) is to limit their access to the database, which is what we are going to do next."),(0,r.kt)("p",null,"The next steps are pretty specific to the Hyperstore database. If you are using your own, you can of course still follow along, but of course you won't be able to copy everything 1:1."),(0,r.kt)("p",null,"As mentioned above, three of our four tenants represent different vendors who use our Hyperstore platform to sell their products. We would like to restrict their access to the database, such that they can only see their products, orders of their products and customers who have bought their products. Veezoo offers two ways to restrict access: ",(0,r.kt)("em",{parentName:"p"},"Authorization over Virtual Tables")," and ",(0,r.kt)("em",{parentName:"p"},"Authorization over Database Connection"),". In this demo, we are going to use ",(0,r.kt)("em",{parentName:"p"},"Virtual Tables"),". If you are interested ",(0,r.kt)("em",{parentName:"p"},"Authorization over Database Connection"),", you can find more information about it in the general embedding guide: ",(0,r.kt)("a",{parentName:"p",href:"https://docs.veezoo.com/docs/embedded/embedded-guide"},"https://docs.veezoo.com/docs/embedded/embedded-guide")),(0,r.kt)("p",null,"In Veezoo, we can create ",(0,r.kt)("em",{parentName:"p"},"Variables")," associated with tenants, which then can be used in the SQL. By default, each tenant already has a ",(0,r.kt)("inlineCode",{parentName:"p"},"veezoo.Tenant.Id")," variable, with the ID you configured earlier. With these we will restrict the access."),(0,r.kt)("p",null,"Virtual tables are basically just extra SQL code put in front of your table. Instead of accessing the ",(0,r.kt)("em",{parentName:"p"},"Customer")," table directly, we first go through this extra step. To create the virtual tables, open ",(0,r.kt)("em",{parentName:"p"},"Veezoo Studio"),' and click on the folder icon (hovering over it displays the text "Show the file tree"). Within the ',(0,r.kt)("em",{parentName:"p"},"database")," folder (not the ",(0,r.kt)("em",{parentName:"p"},"knowledge-base")," folder!) find the folder labeled ",(0,r.kt)("em",{parentName:"p"},"Product")," and open the ",(0,r.kt)("inlineCode",{parentName:"p"},"table.ttl")," file. It should look something like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'db.storage.embedded_hyperstore.public {\n    table Product {\n        identifier: "Product"\n        \n        \n        column Category {\n            identifier: "Category"\n            primitive_type: "text"\n        }\n...\n')),(0,r.kt)("p",null,"(The first line might look slightly different, but that doesn't matter and we aren't going to change it)\nChange it to this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'db.storage.embedded_hyperstore.public {\n    virtual_table Product {\n        identifier: "Product"\n        virtual_table_sql: \n         """\n             SELECT\n                 *\n             FROM\n                 "Product" p\n             WHERE\n                 p."Provider ID" = ${quote(veezoo.Tenant.Id)}\n             OR\n                 ${quote(veezoo.Tenant.Id)} = 0\n            """\n        \n        \n        column Category {\n            identifier: "Category"\n            primitive_type: "text"\n        }\n...\n')),(0,r.kt)("p",null,"Now, when you ask questions about the product, the ",(0,r.kt)("inlineCode",{parentName:"p"},"virtual_table_sql")," will be executed first, and using the Tenant ID. For example as a Technology Shop tenant with ID = 3 you will only see products with ",(0,r.kt)("em",{parentName:"p"},"Provider ID = 3"),' (which in our example are all the products that are in the "Technology" ',(0,r.kt)("em",{parentName:"p"},"Category"),"). The ",(0,r.kt)("inlineCode",{parentName:"p"},"OR"),"clause is added so that the Admin user can see everything."),(0,r.kt)("p",null,"In a similar fashion, change the ",(0,r.kt)("inlineCode",{parentName:"p"},"table.ttl")," files within the ",(0,r.kt)("em",{parentName:"p"},"Customer")," and ",(0,r.kt)("em",{parentName:"p"},"Order")," folders.\n",(0,r.kt)("em",{parentName:"p"},"Order"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'db.storage.embedded_hyperstore.public {\n    virtual_table Order {\n        identifier: "Order"\n        virtual_table_sql: \n         """\n             SELECT\n                 o.*\n             FROM\n                 "Order" o\n             JOIN\n                 "Product" p\n             ON\n                 o."Product ID" = p."Product ID"\n             WHERE\n                 p."Provider ID" = ${quote(veezoo.Tenant.Id)}\n             OR\n                 ${quote(veezoo.Tenant.Id)} = 0\n            """\n...\n')),(0,r.kt)("p",null,"and ",(0,r.kt)("em",{parentName:"p"},"Customer"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'db.storage.embedded_hyperstore.public {\n    virtual_table Customer {\n        identifier: "Customer"\n        virtual_table_sql: \n         """\n             SELECT DISTINCT\n                 c.*\n             FROM\n                 "Customer" c\n             JOIN\n                 "Order" o\n             ON\n                 c."Customer ID" = o."Customer ID"\n             JOIN\n                 "Product" p\n             ON\n                 o."Product ID" = p."Product ID"\n             WHERE\n                 p."Provider ID" = ${quote(veezoo.Tenant.Id)}\n             OR\n                 ${quote(veezoo.Tenant.Id)} = 0\n            """\n...\n')),(0,r.kt)("p",null,"This is already everything we need to add. Save the changes. Now we need to update the tenants ",(0,r.kt)("em",{parentName:"p"},"knowledge graph"),". In ",(0,r.kt)("em",{parentName:"p"},"Veezoo Studio"),", go to ",(0,r.kt)("em",{parentName:"p"},"Tenant Access"),", select all tenants and click on ",(0,r.kt)("em",{parentName:"p"},"UPDATE"),"."),(0,r.kt)("p",null,"The last thing we need to do, is to give the default user (you, when you access this ",(0,r.kt)("em",{parentName:"p"},"knowledge graph")," via regular Veezoo) a ",(0,r.kt)("inlineCode",{parentName:"p"},"veezoo.Tenant.Id")," value (right now you would get error messages in the chat, since the SQL code now uses this variable). Click on the pencil icon in the top row (the one without ",(0,r.kt)("em",{parentName:"p"},"Tenant ID")," or ",(0,r.kt)("em",{parentName:"p"},"Name"),") and set the ID to 0."),(0,r.kt)("p",null,"Congraz, you are done! :-)"),(0,r.kt)("p",null,'If you now open the chat in your demo website again, you will get different results for different users. To see this clearly, type "Products" and you will see that all of the displayed ones have the same ',(0,r.kt)("em",{parentName:"p"},"Category")," (except of course you are logged in with the Admin account)."),(0,r.kt)("h3",{id:"conclusion"},"Conclusion"),(0,r.kt)("p",null,"I hope you have fun playing around with this demo. If you want to build your own project, or run into problems when tinkering with this one, I recommend looking into the embedded Veezoo docs, where you can find more detailed explanations, or contact Veezoo, we are happy to help! "),(0,r.kt)("p",null,"I wish you a nice day, and hopefully we can soon help you empower your Software by embedding Veezoo :-)"))}m.isMDXComponent=!0}}]);