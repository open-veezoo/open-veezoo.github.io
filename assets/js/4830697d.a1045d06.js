"use strict";(self.webpackChunkveezoo_docs=self.webpackChunkveezoo_docs||[]).push([[8975],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=c(n),h=r,m=u["".concat(s,".").concat(h)]||u[h]||p[h]||o;return n?a.createElement(m,l(l({ref:t},d),{},{components:n})):a.createElement(m,l({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=h;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[u]="string"==typeof e?e:r,l[1]=i;for(var c=2;c<o;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},6912:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return u}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),l=["components"],i={id:"kg-sync",title:"Knowledge Graph Sync",sidebar_label:"Why and how to sync?"},s=void 0,c={unversionedId:"kg-sync/kg-sync",id:"kg-sync/kg-sync",title:"Knowledge Graph Sync",description:"Why keep your Knowledge Graph synchronized?",source:"@site/docs/kg-sync/kg-sync.md",sourceDirName:"kg-sync",slug:"/kg-sync/",permalink:"/docs/kg-sync/",draft:!1,editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/kg-sync/kg-sync.md",tags:[],version:"current",frontMatter:{id:"kg-sync",title:"Knowledge Graph Sync",sidebar_label:"Why and how to sync?"},sidebar:"docs",previous:{title:"Row-Level Permission",permalink:"/docs/authorization/row-level-permission"},next:{title:"name",permalink:"/docs/reference/kb-layer/general/name"}},d={},u=[{value:"Why keep your Knowledge Graph synchronized?",id:"why-keep-your-knowledge-graph-synchronized",level:2},{value:"What does &quot;synchronization&quot; mean?",id:"what-does-synchronization-mean",level:3},{value:"What should you sync?",id:"what-should-you-sync",level:3},{value:"How do I synchronize it?",id:"how-do-i-synchronize-it",level:2},{value:"Manual Sync",id:"manual-sync",level:3},{value:"Scheduled Sync",id:"scheduled-sync",level:3},{value:"Scheduled Sync with Sync Policy",id:"scheduled-sync-with-sync-policy",level:3}],p={toc:u},h="wrapper";function m(e){var t=e.components,i=(0,r.Z)(e,l);return(0,o.kt)(h,(0,a.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"why-keep-your-knowledge-graph-synchronized"},"Why keep your Knowledge Graph synchronized?"),(0,o.kt)("p",null,"The Knowledge Graph is a semantic representation of your data and, because of that, it needs to know the values (entities) in your data."),(0,o.kt)("p",null,"When we talk about synchronizing the Knowledge Graph, we mean keeping these database values up-to-date, not the database schema."),(0,o.kt)("h3",{id:"what-does-synchronization-mean"},'What does "synchronization" mean?'),(0,o.kt)("p",null,"To understand the importance of synchronization, let's consider an example. You have a table in your database, where each row represents an order. The existing data might look something like this:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"order_id"),(0,o.kt)("th",{parentName:"tr",align:null},"customer_id"),(0,o.kt)("th",{parentName:"tr",align:null},"customer_name"),(0,o.kt)("th",{parentName:"tr",align:null},"product_id"),(0,o.kt)("th",{parentName:"tr",align:null},"product_name"),(0,o.kt)("th",{parentName:"tr",align:null},"product_description"),(0,o.kt)("th",{parentName:"tr",align:null},"category"),(0,o.kt)("th",{parentName:"tr",align:null},"price"),(0,o.kt)("th",{parentName:"tr",align:null},"order_date"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"1"),(0,o.kt)("td",{parentName:"tr",align:null},"1"),(0,o.kt)("td",{parentName:"tr",align:null},"John Doe"),(0,o.kt)("td",{parentName:"tr",align:null},"2"),(0,o.kt)("td",{parentName:"tr",align:null},"Jeans"),(0,o.kt)("td",{parentName:"tr",align:null},"Comfortable blue denim jeans that are perfect for everyday wear"),(0,o.kt)("td",{parentName:"tr",align:null},"Clothing"),(0,o.kt)("td",{parentName:"tr",align:null},"50"),(0,o.kt)("td",{parentName:"tr",align:null},"2023-01-01")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"2"),(0,o.kt)("td",{parentName:"tr",align:null},"2"),(0,o.kt)("td",{parentName:"tr",align:null},"Jane Smith"),(0,o.kt)("td",{parentName:"tr",align:null},"1"),(0,o.kt)("td",{parentName:"tr",align:null},"T-shirt"),(0,o.kt)("td",{parentName:"tr",align:null},"Simple white cotton t-shirt that pairs well with any outfit"),(0,o.kt)("td",{parentName:"tr",align:null},"Clothing"),(0,o.kt)("td",{parentName:"tr",align:null},"20"),(0,o.kt)("td",{parentName:"tr",align:null},"2023-01-02")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"3"),(0,o.kt)("td",{parentName:"tr",align:null},"1"),(0,o.kt)("td",{parentName:"tr",align:null},"John Doe"),(0,o.kt)("td",{parentName:"tr",align:null},"3"),(0,o.kt)("td",{parentName:"tr",align:null},"Watch"),(0,o.kt)("td",{parentName:"tr",align:null},"Durable stainless steel watch with a modern design"),(0,o.kt)("td",{parentName:"tr",align:null},"Accessories"),(0,o.kt)("td",{parentName:"tr",align:null},"150"),(0,o.kt)("td",{parentName:"tr",align:null},"2023-01-03")))),(0,o.kt)("p",null,'Let\'s say your data gets updated, and a new row is added where a new product (e.g. a "Dress") is sold in a new category (e.g. "Formal Wear").'),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"order_id"),(0,o.kt)("th",{parentName:"tr",align:null},"customer_id"),(0,o.kt)("th",{parentName:"tr",align:null},"customer_name"),(0,o.kt)("th",{parentName:"tr",align:null},"product_id"),(0,o.kt)("th",{parentName:"tr",align:null},"product_name"),(0,o.kt)("th",{parentName:"tr",align:null},"product_description"),(0,o.kt)("th",{parentName:"tr",align:null},"category"),(0,o.kt)("th",{parentName:"tr",align:null},"price"),(0,o.kt)("th",{parentName:"tr",align:null},"order_date"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"4"),(0,o.kt)("td",{parentName:"tr",align:null},"3"),(0,o.kt)("td",{parentName:"tr",align:null},"Bob Brown"),(0,o.kt)("td",{parentName:"tr",align:null},"4"),(0,o.kt)("td",{parentName:"tr",align:null},"Dress"),(0,o.kt)("td",{parentName:"tr",align:null},"Elegant red silk evening gown with beautiful beading and a dramatic silhouette. Ideal for formal occasions."),(0,o.kt)("td",{parentName:"tr",align:null},"Formal Wear"),(0,o.kt)("td",{parentName:"tr",align:null},"100"),(0,o.kt)("td",{parentName:"tr",align:null},"2023-01-04")))),(0,o.kt)("p",null,"Without syncing, Veezoo will not understand if you mention the word 'Dress' or 'Formal Wear' in a question."),(0,o.kt)("p",null,'You would want to synchronize your Knowledge Graph so that it is aware of the new product "Dress" and the new category "Formal Wear". This is necessary to allow Veezoo to ',(0,o.kt)("em",{parentName:"p"},"understand questions"),' related to these new entities, e.g. "How many orders of Dresses were there this year?"'),(0,o.kt)("p",null,"In contrast, if another row is added where an existing customer buys an existing product, like so:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"order_id"),(0,o.kt)("th",{parentName:"tr",align:null},"customer_id"),(0,o.kt)("th",{parentName:"tr",align:null},"customer_name"),(0,o.kt)("th",{parentName:"tr",align:null},"product_id"),(0,o.kt)("th",{parentName:"tr",align:null},"product_name"),(0,o.kt)("th",{parentName:"tr",align:null},"product_description"),(0,o.kt)("th",{parentName:"tr",align:null},"category"),(0,o.kt)("th",{parentName:"tr",align:null},"price"),(0,o.kt)("th",{parentName:"tr",align:null},"order_date"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"5"),(0,o.kt)("td",{parentName:"tr",align:null},"1"),(0,o.kt)("td",{parentName:"tr",align:null},"John Doe"),(0,o.kt)("td",{parentName:"tr",align:null},"1"),(0,o.kt)("td",{parentName:"tr",align:null},"T-shirt"),(0,o.kt)("td",{parentName:"tr",align:null},"Simple white cotton t-shirt that pairs well with any outfit"),(0,o.kt)("td",{parentName:"tr",align:null},"Clothing"),(0,o.kt)("td",{parentName:"tr",align:null},"20"),(0,o.kt)("td",{parentName:"tr",align:null},"2023-01-04")))),(0,o.kt)("p",null,"In this case, there are no new entities that the Knowledge Graph needs to be aware of. So even if a sync did not run since the new order came in, Veezoo will still understand a question about 'T-shirt' or 'Clothing'."),(0,o.kt)("p",null,"In other words, the Knowledge Graph is used to ",(0,o.kt)("strong",{parentName:"p"},"understand a question, not to answer it"),". The actual answers to your questions are computed based on the most recent state of your database, using SQL."),(0,o.kt)("p",null,"The Knowledge Graph will contain the individual distinct values of a database column (e.g. your products), but not all the rows in your database (e.g. all the transactions from these products and the revenue, etc)."),(0,o.kt)("h3",{id:"what-should-you-sync"},"What should you sync?"),(0,o.kt)("p",null,"Due to the purpose of sync as described above, you can only sync classes in Veezoo. But not all classes make sense to sync."),(0,o.kt)("p",null,"Following the example above, here is what would make sense to sync:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Products"),': If new products are being added, you\'d want to sync the Product class to reflect these changes. This way, when you ask Veezoo "How many orders of Dresses did we sell last month?" it will be able to understand and answer the question correctly, even for newly added products.')),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Categories"),': If new product categories are being introduced, the Category class should be synced. This will allow Veezoo to understand questions like "How much revenue did we generate from the Clothing category last year?"')),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"(Potentially) Customers"),': If you\'re interested in asking questions related to specific customers, then syncing the Customer class can be useful. This allows Veezoo to understand queries like "What did John Doe purchase last month?". If there are millions of customers though, Veezoo does not support syncing and you may want to ask using ',(0,o.kt)("inlineCode",{parentName:"p"},"string")," or the ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/kb-layer/attribute/extends/id/"},"onto.ID pattern"),"."))),(0,o.kt)("p",null,"Here is what you CANNOT sync or MAY NOT want to sync:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Price"),': Since it is not a class, you cannot sync Price. Questions like "What is the total revenue from T-shirts last month?" don\'t require the Knowledge Graph to know the individual prices. The calculation of revenue happens at the level of the database, not at the level of the Knowledge Graph.')),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Product Description"),": The description column is not necessary to sync because it typically doesn't contribute to the understanding of a question. The Knowledge Graph is used to understand questions and map them to the appropriate entities. The description of a product wouldn't typically be part of a question posed to Veezoo. The best practice is also to model Description as a ",(0,o.kt)("inlineCode",{parentName:"p"},"string")," and not a ",(0,o.kt)("inlineCode",{parentName:"p"},"class"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Order Date"),": The order_date column cannot by synced because it is not a class and doesn't play a role in understanding the questions.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Order ID"),": The Orders class is usually not synced, because often users won't care about asking questions about specific Order IDs. Even if they want to do so, you should follow the ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/kb-layer/attribute/extends/id/"},"onto.ID pattern")," instead."))),(0,o.kt)("h2",{id:"how-do-i-synchronize-it"},"How do I synchronize it?"),(0,o.kt)("h3",{id:"manual-sync"},"Manual Sync"),(0,o.kt)("p",null,"By default, Veezoo does not automatically schedule to sync the Knowledge Graph."),(0,o.kt)("p",null,"So the most common way to sync it is by:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Open in Veezoo Studio the file for the class you want to sync (under ",(0,o.kt)("inlineCode",{parentName:"li"},"knowledge-base/classes/..."),'). You can get there quickly by going to the Knowledge Graph sidebar, hovering over the class and clicking to "Open in Studio" in the info panel.')),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Open in Veezoo Studio",src:n(195).Z,width:"601",height:"482"})),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"You will notice on the top bar of the file a sync icon.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Sync Button",src:n(6434).Z,width:"695",height:"551"})),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Click on it and select the classes you want to sync.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Choose Classes",src:n(9737).Z,width:"714",height:"426"})),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"Wait... and that's it.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Success",src:n(4585).Z,width:"644",height:"88"})),(0,o.kt)("h3",{id:"scheduled-sync"},"Scheduled Sync"),(0,o.kt)("p",null,"If there are always new individual values being added, you may want to schedule your sync to run with a certain frequency."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"To do this, go to the ",(0,o.kt)("inlineCode",{parentName:"li"},"Synchronization")," view in Studio.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Synchronization",src:n(6186).Z,width:"1882",height:"864"}),"   "),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click on the ",(0,o.kt)("inlineCode",{parentName:"p"},"+ SCHEDULE")," button.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select when the sync should start and how frequent (once, every hour, every day, every week)."))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Start and Frequency",src:n(7741).Z,width:"763",height:"592"}),"   "),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"Now you can choose which concepts should be synced or whether you want all concepts with an explicit sync policy set to be synced (see next section).")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Concepts",src:n(6983).Z,width:"788",height:"609"}),"   "),(0,o.kt)("h3",{id:"scheduled-sync-with-sync-policy"},"Scheduled Sync with Sync Policy"),(0,o.kt)("p",null,"To do that, you will need to:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Open Veezoo Studio and open the file for each class you want to schedule the sync.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Inside each class you want to sync, add a sync_policy:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"If you want to keep changes you may have done to the entities (e.g. synonyms, renaming), add: ",(0,o.kt)("inlineCode",{parentName:"p"},'sync_policy: "merge"'))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"If you want to always replace the entities with the new ones: ",(0,o.kt)("inlineCode",{parentName:"p"},'sync_policy: "replace"')))))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'\nkb {\n    class Product {\n        name.en: "Product"\n        \n        from_table: product\n        sql: "${product.product_id}"\n        name_sql.en: "${product.product_name}"\n        \n        extends: onto.Product\n        \n        sync_policy: "replace"\n        \n        class Category {\n            name.en: "Category"\n            \n            sync_policy: "merge"\n\n            sql: "${product.category}"\n        }\n        \n        class Sub_Category {\n            name.en: "Sub Category"\n            \n            sql: "${product.sub_category}"\n        }\n    }\n}\n\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If you want a class to have a ",(0,o.kt)("inlineCode",{parentName:"li"},"name_sql")," that is shown in the queries, but without syncing them, because they contain too many values: ",(0,o.kt)("inlineCode",{parentName:"li"},'sync_policy: "ignore"'),".")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'\nkb {\n\n    // There may be millions of customers in your database and these should not be indexed in Veezoo (we also have a hard-limit here)\n    // but you don\'t want customers to be displayed with just their id, but rather with "first_name last_name"\n    // To achieve this, set sync_policy: "ignore"\n    class Customer {\n        name.en: "Customer"\n        \n        from_table: customer\n        sql: "${customer.id}"\n        name_sql.en: "${customer.first_name} || \' \' || ${customer.last_name}"\n\n        sync_policy: "ignore"\n        \n        ...\n    }\n}\n\n')),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Save and go to the ",(0,o.kt)("inlineCode",{parentName:"p"},"Synchronization")," view again for your Knowledge Graph in Veezoo Studio.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Follow the steps in the previous section ",(0,o.kt)("inlineCode",{parentName:"p"},"Scheduled Sync"),", but choose to sync ",(0,o.kt)("inlineCode",{parentName:"p"},"All concepts with a sync policy"),". If you only set ",(0,o.kt)("inlineCode",{parentName:"p"},'sync_policy: "ignore"'),", you don't need to do this."))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"All concepts with a sync policy",src:n(2798).Z,width:"433",height:"116"})))}m.isMDXComponent=!0},9737:function(e,t,n){t.Z=n.p+"assets/images/choose-classes-2abf0e10624741093f9650fbb9aebe80.png"},6983:function(e,t,n){t.Z=n.p+"assets/images/concepts-27e8fad6dcf2983478c1a1fe4a5c3d9a.png"},2798:function(e,t,n){t.Z=n.p+"assets/images/concepts_with_sync_policy-460da49ac0f56ad07baa9ae8d99340e8.png"},195:function(e,t,n){t.Z=n.p+"assets/images/open-in-studio-e159a8a18c4790d7a56d62eb95826562.png"},7741:function(e,t,n){t.Z=n.p+"assets/images/start_frequency-ea3bb0cbd9637dbc34f0a6dcf5a1e4e5.png"},4585:function(e,t,n){t.Z=n.p+"assets/images/success-d2548f1fa166cbfd62fb20e8a9c9d909.png"},6434:function(e,t,n){t.Z=n.p+"assets/images/sync-button-58a0e26f093b1811e2f2b12d42686dbc.png"},6186:function(e,t,n){t.Z=n.p+"assets/images/synchronization-219a2fc411f72d1d108eef337fb5f181.png"}}]);